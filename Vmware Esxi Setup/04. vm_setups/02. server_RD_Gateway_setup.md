 RD Gateway (RDGW01) Setup â€“ Full GUI Steps (with Domain Join)
âœ… Step 1: Set Static IP on Internal NIC (192.168.0.6)
Open Network Connections
â†’ Control Panel > Network and Sharing > Change adapter settings

Right-click Internal NIC (vSwitch1) â†’ Properties â†’ Internet Protocol Version 4 (TCP/IPv4)

Set:

IP: 192.168.0.6

Subnet: 255.255.255.0

Gateway: (leave blank)

DNS: 192.168.0.5 (DC01)

âš ï¸ Don't set a gateway here. Only set DNS to point to the domain controller.

âœ… Step 2: Join RDGW01 to Domain (infra.local)
Right-click This PC â†’ Properties

Click Rename this PC (advanced) or "Change Settings"

Click Changeâ€¦

Select Domain

Enter: infra.local

Enter domain admin credentials when prompted (e.g., infra\Administrator)

Restart the machine when asked

ðŸ”„ After reboot, login using: infra\Administrator

âœ… Step 3: Rename Computer (Optional)
Go to System Properties

Click Changeâ€¦

Set Computer Name: RDGW01

Restart if changed

âœ… Step 4: Install RD Gateway Role
Open Server Manager

Click Manage > Add Roles and Features

Choose:

Installation Type: Role-based or feature-based

Server: local machine

Under Roles:

Expand Remote Desktop Services

Check âœ… Remote Desktop Gateway

Click Next â†’ Install

Reboot if required

âœ… Step 5: Configure RD Gateway in GUI
Open:
Server Manager > Tools > Remote Desktop Gateway Manager

In RD Gateway Manager:

Right-click the RDGW server â†’ Properties

ðŸ” Step 6: Add SSL Certificate
Go to the SSL Certificate tab

Click Import a certificate (or choose self-signed)

For now:

Use self-signed if no public cert available

Or generate via IIS if needed later

âœ… Step 7: Create Authorization Policies
ðŸŸ¢ Connection Authorization Policy (RD-CAP)
In RD Gateway Manager â†’ Expand server â†’ Right-click Connection Authorization Policies â†’ New

Name: AllowDomainUsers

Select:

User Groups â†’ Add: Domain Users

Authentication Method: Password only

Finish â†’ âœ… Policy Created

ðŸŸ¢ Resource Authorization Policy (RD-RAP)
Right-click Resource Authorization Policies â†’ New

Name: AllowRDSAccess

Select:

User Groups: Domain Users

Network Resource Groups: Add RDS01, RDS02 (or infra.local\Computers)

Finish

ðŸ”§ Step 8: Enable Firewall Rules (Optional Manual Check)
Open Windows Defender Firewall > Advanced Settings

Inbound Rules:

Ensure Remote Desktop Gateway rules are enabled (port 443)

Ensure Remote Desktop - User Mode (TCP-In) is enabled (port 3389)

Outbound:

Ensure RDGW can connect to 192.168.0.10 on port 3389

ðŸ§ª Step 9: Test RDP via RD Gateway (from client)
On a remote client:

Open MSTSC

In Show Options > Advanced > Settings:

RD Gateway: 138.X.X.X

Use your domain credentials (e.g., infra\testuser)

Back in General tab:

Computer: 192.168.0.10

âœ… You should land on RDS01's desktop, tunneled via HTTPS (443)

ðŸŽ¯ Done â€” RD Gateway Now Working
Item	Value
Public IP	138.X.X.X (vNIC 1)
Private IP	192.168.0.6 (vNIC 2)
Gateway	Only on Public NIC
DNS	192.168.0.5 (DC01)
Domain Joined	Yes (infra.local)